<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarrakFit ‚Äì Votre coach calories & macros made in Morocco</title>
    <style>
        :root {
            --primary-color: #C1272D; /* Rouge Marrakech */
            --primary-dark: #A02025;
            --primary-light: #E8B4B6;
            --secondary-color: #D4AF37; /* Or marocain */
            --secondary-dark: #B8941F;
            --secondary-light: #F4E4A9;
            --accent-color: #228B22; /* Vert palmier */
            --text-color: #2F2F2F;
            --text-light: #666;
            --background-color: #FDF6E3; /* Beige sable */
            --card-background: #FFFFFF;
            --border-color: #E0D6C3;
            --error-color: #C1272D;
            --success-color: #228B22;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            min-height: 100vh;
            position: relative;
            transition: all 0.3s ease;
        }

        /* Arri√®re-plan avec palmiers */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M50,10 C60,20 65,30 60,40 C55,50 45,55 50,65 C55,75 60,80 50,90 C40,80 45,75 50,65 C55,55 45,50 40,40 C35,30 40,20 50,10 Z" fill="%23228B22" opacity="0.1"/></svg>');
            background-size: 200px;
            opacity: 0.3;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .language-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .language-btn:hover {
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .language-options {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 10px 0;
            margin-top: 5px;
            display: none;
            min-width: 150px;
        }

        .language-options.show {
            display: block;
        }

        .language-option {
            padding: 8px 15px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .language-option:hover {
            background: var(--primary-light);
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        /* Motif marocain d√©coratif */
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M50,10 C60,20 65,30 60,40 C55,50 45,55 50,65 C55,75 60,80 50,90 C40,80 45,75 50,65 C55,55 45,50 40,40 C35,30 40,20 50,10 Z" fill="white" opacity="0.1"/></svg>');
            background-size: 150px;
            opacity: 0.2;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .section {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .section:hover {
            transform: translateY(-5px);
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-dark);
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: "‚ú¶";
            color: var(--secondary-color);
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            transition: border 0.3s;
            background-color: #FFF;
        }

        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(193, 39, 45, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .radio-option input {
            width: auto;
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 5px;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(193, 39, 45, 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(212, 175, 55, 0.3);
        }

        .result-card {
            background: linear-gradient(135deg, #FDF6E3, #F4E4A9);
            border-left: 5px solid var(--primary-color);
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .result-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--primary-dark);
        }

        .result-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .nutrition-plan {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .meal-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border: 1px solid var(--border-color);
        }

        .meal-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }

        .meal-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .meal-title::before {
            content: "üçΩÔ∏è";
        }

        .food-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
        }

        .food-item:last-child {
            border-bottom: none;
        }

        .food-name {
            font-weight: 500;
        }

        .food-quantity {
            color: var(--text-light);
        }

        .meal-total {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 2px solid var(--primary-light);
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            background-color: #F9F5EB;
            padding: 10px;
            border-radius: 5px;
        }

        .hidden {
            display: none;
        }

        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .step.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 2px 5px rgba(193, 39, 45, 0.3);
        }

        .step.completed {
            background-color: var(--success-color);
            color: white;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background-color: #e0e0e0;
            z-index: 1;
        }

        .food-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .nutrition-plan {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .language-selector {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
                display: flex;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- S√©lecteur de langue -->
        <div class="language-selector">
            <div class="language-btn" id="languageBtn">
                <span>üåê</span>
                <span id="currentLanguage">Fran√ßais</span>
                <span>‚ñº</span>
            </div>
            <div class="language-options" id="languageOptions">
                <div class="language-option" data-lang="fr">Fran√ßais</div>
                <div class="language-option" data-lang="en">English</div>
                <div class="language-option" data-lang="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</div>
            </div>
        </div>

        <header>
            <h1 id="appTitle">MarrakFit ‚Äì Votre coach calories & macros made in Morocco</h1>
            <p id="appSubtitle">Obtenez votre plan alimentaire personnalis√© selon vos objectifs</p>
        </header>

        <div class="app-container">
            <!-- Indicateur de progression -->
            <div class="step-indicator">
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
                <div class="step" id="step4">4</div>
            </div>

            <!-- √âtape 1: Informations personnelles -->
            <section id="personalInfoSection" class="section">
                <h2 class="section-title" id="personalInfoTitle">Informations Personnelles</h2>
                <form id="personalInfoForm">
                    <div class="form-group">
                        <label for="age" id="ageLabel">√Çge</label>
                        <input type="number" id="age" min="15" max="100" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="gender" id="genderLabel">Genre</label>
                        <select id="gender" required>
                            <option value="" id="genderDefault">S√©lectionnez votre genre</option>
                            <option value="male" id="genderMale">Homme</option>
                            <option value="female" id="genderFemale">Femme</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="weight" id="weightLabel">Poids (kg)</label>
                        <input type="number" id="weight" min="30" max="200" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="height" id="heightLabel">Taille (cm)</label>
                        <input type="number" id="height" min="100" max="250" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="activityLevel" id="activityLabel">Niveau d'activit√©</label>
                        <select id="activityLevel" required>
                            <option value="" id="activityDefault">S√©lectionnez votre niveau d'activit√©</option>
                            <option value="1.2" id="activitySedentary">S√©dentaire (peu ou pas d'exercice)</option>
                            <option value="1.375" id="activityLight">L√©g√®rement actif (1-3 jours/semaine)</option>
                            <option value="1.55" id="activityModerate">Mod√©r√©ment actif (3-5 jours/semaine)</option>
                            <option value="1.725" id="activityActive">Tr√®s actif (6-7 jours/semaine)</option>
                            <option value="1.9" id="activityExtreme">Extr√™mement actif (entra√Ænement intense quotidien)</option>
                        </select>
                    </div>
                    
                    <button type="button" id="nextToGoalBtn" class="btn-primary">Suivant</button>
                </form>
            </section>

            <!-- √âtape 2: Objectif -->
            <section id="goalSection" class="section hidden">
                <h2 class="section-title" id="goalTitle">Votre Objectif</h2>
                <form id="goalForm">
                    <div class="form-group">
                        <label id="goalQuestion">Que souhaitez-vous atteindre ?</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="goalMuscle" name="goal" value="muscle" required>
                                <label for="goalMuscle" id="goalMuscleLabel">Prendre du muscle</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="goalWeightLoss" name="goal" value="weightLoss">
                                <label for="goalWeightLoss" id="goalWeightLossLabel">Perdre du poids</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="goalMaintain" name="goal" value="maintain">
                                <label for="goalMaintain" id="goalMaintainLabel">Maintenir mon poids</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="intensity" id="intensityLabel">Intensit√© de l'objectif</label>
                        <select id="intensity" required>
                            <option value="" id="intensityDefault">S√©lectionnez l'intensit√©</option>
                            <option value="250" id="intensityLight">L√©ger (+/- 250 kcal)</option>
                            <option value="500" selected id="intensityModerate">Mod√©r√© (+/- 500 kcal)</option>
                            <option value="750" id="intensityIntense">Intense (+/- 750 kcal)</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="backToPersonalBtn" class="btn-secondary">Pr√©c√©dent</button>
                        <button type="button" id="nextToResultsBtn" class="btn-primary">Calculer mes besoins</button>
                    </div>
                </form>
            </section>

            <!-- √âtape 3: R√©sultats des calculs -->
            <section id="resultsSection" class="section hidden">
                <h2 class="section-title" id="resultsTitle">Vos Besoins Nutritionnels</h2>
                
                <div class="result-card">
                    <h3 class="result-title" id="bmrTitle">Votre m√©tabolisme de base (BMR)</h3>
                    <div class="result-value" id="bmrResult">0 calories</div>
                    <p id="bmrDescription">Calories n√©cessaires au repos pour maintenir les fonctions vitales</p>
                </div>
                
                <div class="result-card">
                    <h3 class="result-title" id="tdeeTitle">Votre d√©pense √©nerg√©tique totale (TDEE)</h3>
                    <div class="result-value" id="tdeeResult">0 calories</div>
                    <p id="tdeeDescription">Calories n√©cessaires en fonction de votre niveau d'activit√©</p>
                </div>
                
                <div class="result-card">
                    <h3 class="result-title" id="goalCaloriesTitle">Calories recommand√©es pour votre objectif</h3>
                    <div class="result-value" id="goalCaloriesResult">0 calories</div>
                    <p id="goalDescription"></p>
                </div>
                
                <div class="result-card">
                    <h3 class="result-title" id="macrosTitle">R√©partition des macronutriments</h3>
                    <div class="macronutrients">
                        <p><strong id="proteinLabel">Prot√©ines:</strong> <span id="proteinResult">0g</span> <span id="proteinInfo"></span></p>
                        <p><strong id="fatLabel">Lipides:</strong> <span id="fatResult">0g</span> <span id="fatInfo"></span></p>
                        <p><strong id="carbsLabel">Glucides:</strong> <span id="carbsResult">0g</span> <span id="carbsInfo">(reste des calories)</span></p>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" id="backToGoalBtn" class="btn-secondary">Pr√©c√©dent</button>
                    <button type="button" id="nextToPlanBtn" class="btn-primary">Voir mon plan nutritionnel</button>
                </div>
            </section>

            <!-- √âtape 4: Plan nutritionnel -->
            <section id="planSection" class="section hidden">
                <h2 class="section-title" id="planTitle">Votre Plan Nutritionnel Quotidien</h2>
                <p id="planDescription">Bas√© sur vos besoins de <span id="dailyCaloriesPlan">0</span> calories</p>
                
                <div class="nutrition-plan" id="nutritionPlan">
                    <!-- Le plan sera g√©n√©r√© ici dynamiquement -->
                </div>
                
                <div class="form-actions">
                    <button type="button" id="backToResultsBtn" class="btn-secondary">Pr√©c√©dent</button>
                    <button type="button" id="restartBtn" class="btn-primary">Recommencer</button>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Textes multilingues
        const translations = {
            fr: {
                appTitle: "MarrakFit ‚Äì Votre coach calories & macros made in Morocco",
                appSubtitle: "Obtenez votre plan alimentaire personnalis√© selon vos objectifs",
                currentLanguage: "Fran√ßais",
                personalInfoTitle: "Informations Personnelles",
                ageLabel: "√Çge",
                genderLabel: "Genre",
                genderDefault: "S√©lectionnez votre genre",
                genderMale: "Homme",
                genderFemale: "Femme",
                weightLabel: "Poids (kg)",
                heightLabel: "Taille (cm)",
                activityLabel: "Niveau d'activit√©",
                activityDefault: "S√©lectionnez votre niveau d'activit√©",
                activitySedentary: "S√©dentaire (peu ou pas d'exercice)",
                activityLight: "L√©g√®rement actif (1-3 jours/semaine)",
                activityModerate: "Mod√©r√©ment actif (3-5 jours/semaine)",
                activityActive: "Tr√®s actif (6-7 jours/semaine)",
                activityExtreme: "Extr√™mement actif (entra√Ænement intense quotidien)",
                nextButton: "Suivant",
                goalTitle: "Votre Objectif",
                goalQuestion: "Que souhaitez-vous atteindre ?",
                goalMuscleLabel: "Prendre du muscle",
                goalWeightLossLabel: "Perdre du poids",
                goalMaintainLabel: "Maintenir mon poids",
                intensityLabel: "Intensit√© de l'objectif",
                intensityDefault: "S√©lectionnez l'intensit√©",
                intensityLight: "L√©ger (+/- 250 kcal)",
                intensityModerate: "Mod√©r√© (+/- 500 kcal)",
                intensityIntense: "Intense (+/- 750 kcal)",
                previousButton: "Pr√©c√©dent",
                calculateButton: "Calculer mes besoins",
                resultsTitle: "Vos Besoins Nutritionnels",
                bmrTitle: "Votre m√©tabolisme de base (BMR)",
                bmrDescription: "Calories n√©cessaires au repos pour maintenir les fonctions vitales",
                tdeeTitle: "Votre d√©pense √©nerg√©tique totale (TDEE)",
                tdeeDescription: "Calories n√©cessaires en fonction de votre niveau d'activit√©",
                goalCaloriesTitle: "Calories recommand√©es pour votre objectif",
                macrosTitle: "R√©partition des macronutriments",
                proteinLabel: "Prot√©ines:",
                fatLabel: "Lipides:",
                carbsLabel: "Glucides:",
                carbsInfo: "(reste des calories)",
                viewPlanButton: "Voir mon plan nutritionnel",
                planTitle: "Votre Plan Nutritionnel Quotidien",
                planDescription: "Bas√© sur vos besoins de",
                restartButton: "Recommencer"
            },
            en: {
                appTitle: "MarrakFit ‚Äì Your calories & macros coach made in Morocco",
                appSubtitle: "Get your personalized meal plan according to your goals",
                currentLanguage: "English",
                personalInfoTitle: "Personal Information",
                ageLabel: "Age",
                genderLabel: "Gender",
                genderDefault: "Select your gender",
                genderMale: "Male",
                genderFemale: "Female",
                weightLabel: "Weight (kg)",
                heightLabel: "Height (cm)",
                activityLabel: "Activity Level",
                activityDefault: "Select your activity level",
                activitySedentary: "Sedentary (little or no exercise)",
                activityLight: "Lightly active (1-3 days/week)",
                activityModerate: "Moderately active (3-5 days/week)",
                activityActive: "Very active (6-7 days/week)",
                activityExtreme: "Extremely active (intense daily training)",
                nextButton: "Next",
                goalTitle: "Your Goal",
                goalQuestion: "What do you want to achieve?",
                goalMuscleLabel: "Gain muscle",
                goalWeightLossLabel: "Lose weight",
                goalMaintainLabel: "Maintain my weight",
                intensityLabel: "Goal intensity",
                intensityDefault: "Select the intensity",
                intensityLight: "Light (+/- 250 kcal)",
                intensityModerate: "Moderate (+/- 500 kcal)",
                intensityIntense: "Intense (+/- 750 kcal)",
                previousButton: "Previous",
                calculateButton: "Calculate my needs",
                resultsTitle: "Your Nutritional Needs",
                bmrTitle: "Your Basal Metabolic Rate (BMR)",
                bmrDescription: "Calories needed at rest to maintain vital functions",
                tdeeTitle: "Your Total Daily Energy Expenditure (TDEE)",
                tdeeDescription: "Calories needed based on your activity level",
                goalCaloriesTitle: "Recommended calories for your goal",
                macrosTitle: "Macronutrient distribution",
                proteinLabel: "Protein:",
                fatLabel: "Fat:",
                carbsLabel: "Carbs:",
                carbsInfo: "(remaining calories)",
                viewPlanButton: "View my nutrition plan",
                planTitle: "Your Daily Nutrition Plan",
                planDescription: "Based on your needs of",
                restartButton: "Restart"
            },
            ar: {
                appTitle: "MarrakFit ‚Äì ŸÖÿØÿ±ÿ® ÿßŸÑÿ≥ÿπÿ±ÿßÿ™ ŸàÿßŸÑŸÖÿßŸÉÿ±Ÿà ŸÖŸÜ ÿßŸÑŸÖÿ∫ÿ±ÿ®",
                appSubtitle: "ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿÆÿ∑ÿ© Ÿàÿ¨ÿ®ÿßÿ™ŸÉ ÿßŸÑÿ¥ÿÆÿµŸäÿ© ŸàŸÅŸÇŸãÿß ŸÑÿ£ŸáÿØÿßŸÅŸÉ",
                currentLanguage: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
                personalInfoTitle: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©",
                ageLabel: "ÿßŸÑÿπŸÖÿ±",
                genderLabel: "ÿßŸÑÿ¨ŸÜÿ≥",
                genderDefault: "ÿßÿÆÿ™ÿ± ÿ¨ŸÜÿ≥ŸÉ",
                genderMale: "ÿ±ÿ¨ŸÑ",
                genderFemale: "ÿßŸÖÿ±ÿ£ÿ©",
                weightLabel: "ÿßŸÑŸàÿ≤ŸÜ (ŸÉÿ¨ŸÖ)",
                heightLabel: "ÿßŸÑÿ∑ŸàŸÑ (ÿ≥ŸÖ)",
                activityLabel: "ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑŸÜÿ¥ÿßÿ∑",
                activityDefault: "ÿßÿÆÿ™ÿ± ŸÖÿ≥ÿ™ŸàŸâ ŸÜÿ¥ÿßÿ∑ŸÉ",
                activitySedentary: "ŸÇŸÑŸäŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿ© (ŸÇŸÑŸäŸÑ ÿ£Ÿà ÿ®ÿØŸàŸÜ ÿ™ŸÖÿßÿ±ŸäŸÜ)",
                activityLight: "ŸÜÿ¥ÿßÿ∑ ÿÆŸÅŸäŸÅ (1-3 ÿ£ŸäÿßŸÖ/ÿ£ÿ≥ÿ®Ÿàÿπ)",
                activityModerate: "ŸÜÿ¥ÿßÿ∑ ŸÖÿπÿ™ÿØŸÑ (3-5 ÿ£ŸäÿßŸÖ/ÿ£ÿ≥ÿ®Ÿàÿπ)",
                activityActive: "ŸÜÿ¥ÿ∑ ÿ¨ÿØŸãÿß (6-7 ÿ£ŸäÿßŸÖ/ÿ£ÿ≥ÿ®Ÿàÿπ)",
                activityExtreme: "ŸÜÿ¥ÿ∑ ŸÑŸÑÿ∫ÿßŸäÿ© (ÿ™ÿØÿ±Ÿäÿ® ŸÖŸÉÿ´ŸÅ ŸäŸàŸÖŸä)",
                nextButton: "ÿßŸÑÿ™ÿßŸÑŸä",
                goalTitle: "ŸáÿØŸÅŸÉ",
                goalQuestion: "ŸÖÿßÿ∞ÿß ÿ™ÿ±ŸäÿØ ÿ£ŸÜ ÿ™ÿ≠ŸÇŸÇÿü",
                goalMuscleLabel: "ÿßŸÉÿ™ÿ≥ÿßÿ® ÿßŸÑÿπÿ∂ŸÑÿßÿ™",
                goalWeightLossLabel: "ŸÅŸÇÿØÿßŸÜ ÿßŸÑŸàÿ≤ŸÜ",
                goalMaintainLabel: "ÿßŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ Ÿàÿ≤ŸÜŸä",
                intensityLabel: "ÿ¥ÿØÿ© ÿßŸÑŸáÿØŸÅ",
                intensityDefault: "ÿßÿÆÿ™ÿ± ÿßŸÑÿ¥ÿØÿ©",
                intensityLight: "ÿÆŸÅŸäŸÅ (+/- 250 ÿ≥ÿπÿ±ÿ©)",
                intensityModerate: "ŸÖÿπÿ™ÿØŸÑ (+/- 500 ÿ≥ÿπÿ±ÿ©)",
                intensityIntense: "ŸÖŸÉÿ´ŸÅ (+/- 750 ÿ≥ÿπÿ±ÿ©)",
                previousButton: "ÿßŸÑÿ≥ÿßÿ®ŸÇ",
                calculateButton: "ÿ≠ÿ≥ÿßÿ® ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™Ÿä",
                resultsTitle: "ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ŸÉ ÿßŸÑÿ∫ÿ∞ÿßÿ¶Ÿäÿ©",
                bmrTitle: "ŸÖÿπÿØŸÑ ÿßŸÑÿ£Ÿäÿ∂ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä (BMR)",
                bmrDescription: "ÿßŸÑÿ≥ÿπÿ±ÿßÿ™ ÿßŸÑÿ≠ÿ±ÿßÿ±Ÿäÿ© ÿßŸÑŸÑÿßÿ≤ŸÖÿ© ŸÅŸä ÿßŸÑÿ±ÿßÿ≠ÿ© ŸÑŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿßŸÑŸàÿ∏ÿßÿ¶ŸÅ ÿßŸÑÿ≠ŸäŸàŸäÿ©",
                tdeeTitle: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿ•ŸÜŸÅÿßŸÇ ÿßŸÑÿ∑ÿßŸÇÿ© ÿßŸÑŸäŸàŸÖŸä (TDEE)",
                tdeeDescription: "ÿßŸÑÿ≥ÿπÿ±ÿßÿ™ ÿßŸÑÿ≠ÿ±ÿßÿ±Ÿäÿ© ÿßŸÑŸÑÿßÿ≤ŸÖÿ© ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ŸÖÿ≥ÿ™ŸàŸâ ŸÜÿ¥ÿßÿ∑ŸÉ",
                goalCaloriesTitle: "ÿßŸÑÿ≥ÿπÿ±ÿßÿ™ ÿßŸÑÿ≠ÿ±ÿßÿ±Ÿäÿ© ÿßŸÑŸÖŸàÿµŸâ ÿ®Ÿáÿß ŸÑŸáÿØŸÅŸÉ",
                macrosTitle: "ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖÿ∫ÿ∞Ÿäÿßÿ™ ÿßŸÑŸÉÿ®ÿ±Ÿâ",
                proteinLabel: "ÿßŸÑÿ®ÿ±Ÿàÿ™ŸäŸÜ:",
                fatLabel: "ÿßŸÑÿØŸáŸàŸÜ:",
                carbsLabel: "ÿßŸÑŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™:",
                carbsInfo: "(ÿßŸÑÿ≥ÿπÿ±ÿßÿ™ ÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ©)",
                viewPlanButton: "ÿπÿ±ÿ∂ ÿÆÿ∑ÿ™Ÿä ÿßŸÑÿ∫ÿ∞ÿßÿ¶Ÿäÿ©",
                planTitle: "ÿÆÿ∑ÿ™ŸÉ ÿßŸÑÿ∫ÿ∞ÿßÿ¶Ÿäÿ© ÿßŸÑŸäŸàŸÖŸäÿ©",
                planDescription: "ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ŸÉ ŸÖŸÜ",
                restartButton: "ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ®ÿØÿ°"
            }
        };

        // √âl√©ments DOM
        const personalInfoSection = document.getElementById('personalInfoSection');
        const goalSection = document.getElementById('goalSection');
        const resultsSection = document.getElementById('resultsSection');
        const planSection = document.getElementById('planSection');
        
        const nextToGoalBtn = document.getElementById('nextToGoalBtn');
        const backToPersonalBtn = document.getElementById('backToPersonalBtn');
        const nextToResultsBtn = document.getElementById('nextToResultsBtn');
        const backToGoalBtn = document.getElementById('backToGoalBtn');
        const nextToPlanBtn = document.getElementById('nextToPlanBtn');
        const backToResultsBtn = document.getElementById('backToResultsBtn');
        const restartBtn = document.getElementById('restartBtn');
        
        const steps = document.querySelectorAll('.step');
        
        // R√©sultats
        const bmrResult = document.getElementById('bmrResult');
        const tdeeResult = document.getElementById('tdeeResult');
        const goalCaloriesResult = document.getElementById('goalCaloriesResult');
        const goalDescription = document.getElementById('goalDescription');
        const proteinResult = document.getElementById('proteinResult');
        const fatResult = document.getElementById('fatResult');
        const carbsResult = document.getElementById('carbsResult');
        const dailyCaloriesPlan = document.getElementById('dailyCaloriesPlan');
        const nutritionPlan = document.getElementById('nutritionPlan');
        const proteinInfo = document.getElementById('proteinInfo');
        const fatInfo = document.getElementById('fatInfo');
        
        // S√©lecteur de langue
        const languageBtn = document.getElementById('languageBtn');
        const languageOptions = document.getElementById('languageOptions');
        const currentLanguage = document.getElementById('currentLanguage');
        
        // Donn√©es de l'utilisateur
        let userData = {
            age: 0,
            gender: '',
            weight: 0,
            height: 0,
            activityLevel: 0,
            goal: '',
            intensity: 0,
            bmr: 0,
            tdee: 0,
            goalCalories: 0,
            protein: 0,
            fat: 0,
            carbs: 0
        };
        
        // Langue actuelle
        let currentLang = 'fr';
        
        // Structure fixe du plan nutritionnel (adaptatif selon les calories)
        const mealStructure = {
            breakfast: {
                name: { fr: "Petit-d√©jeuner", en: "Breakfast", ar: "ÿßŸÑÿ•ŸÅÿ∑ÿßÿ±" },
                baseCalories: 500,
                foods: [
                    { name: { fr: "≈íufs (3 moyens)", en: "Eggs (3 medium)", ar: "ÿ®Ÿäÿ∂ (3 ÿ≠ÿ®ÿßÿ™ ŸÖÿ™Ÿàÿ≥ÿ∑ÿ©)" }, baseQuantity: 150, calories: 149, protein: 10, carbs: 1.6, fat: 11 },
                    { name: { fr: "Pain complet (2 tranches)", en: "Whole wheat bread (2 slices)", ar: "ÿÆÿ®ÿ≤ ÿßŸÑŸÇŸÖÿ≠ ÿßŸÑŸÉÿßŸÖŸÑ (2 ÿ¥ÿ±Ÿäÿ≠ÿ©)" }, baseQuantity: 50, calories: 265, protein: 13, carbs: 44, fat: 3.4 },
                    { name: { fr: "Avocat (50g)", en: "Avocado (50g)", ar: "ÿ£ŸÅŸàŸÉÿßÿØŸà (50 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 50, calories: 160, protein: 2, carbs: 9, fat: 15 },
                    { name: { fr: "Orange ou pomme", en: "Orange or apple", ar: "ÿ®ÿ±ÿ™ŸÇÿßŸÑ ÿ£Ÿà ÿ™ŸÅÿßÿ≠ÿ©" }, baseQuantity: 100, calories: 52, protein: 0.3, carbs: 14, fat: 0.2 }
                ]
            },
            morningSnack: {
                name: { fr: "Collation du matin", en: "Morning snack", ar: "Ÿàÿ¨ÿ®ÿ© ÿÆŸÅŸäŸÅÿ© ÿµÿ®ÿßÿ≠Ÿäÿ©" },
                baseCalories: 200,
                foods: [
                    { name: { fr: "Yaourt nature", en: "Plain yogurt", ar: "ÿ≤ÿ®ÿßÿØŸä ÿ∑ÿ®ŸäÿπŸä" }, baseQuantity: 150, calories: 59, protein: 10, carbs: 3.6, fat: 0.4 },
                    { name: { fr: "Amandes (15g)", en: "Almonds (15g)", ar: "ŸÑŸàÿ≤ (15 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 15, calories: 579, protein: 21, carbs: 22, fat: 50 },
                    { name: { fr: "Fruits rouges ou banane", en: "Berries or banana", ar: "ŸÅŸàÿßŸÉŸá ÿ≠ŸÖÿ±ÿßÿ° ÿ£Ÿà ŸÖŸàÿ≤" }, baseQuantity: 100, calories: 89, protein: 1.1, carbs: 23, fat: 0.3 }
                ]
            },
            lunch: {
                name: { fr: "D√©jeuner", en: "Lunch", ar: "ÿßŸÑÿ∫ÿØÿßÿ°" },
                baseCalories: 600,
                foods: [
                    { name: { fr: "Poulet grill√© (150g)", en: "Grilled chicken (150g)", ar: "ÿØÿ¨ÿßÿ¨ ŸÖÿ¥ŸàŸä (150 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 150, calories: 165, protein: 31, carbs: 0, fat: 3.6 },
                    { name: { fr: "Riz complet (100g cuit)", en: "Brown rice (100g cooked)", ar: "ÿ£ÿ±ÿ≤ ÿ®ŸÜŸä (100 ÿ¨ÿ±ÿßŸÖ ŸÖÿ∑ÿ®ŸàÿÆ)" }, baseQuantity: 100, calories: 111, protein: 2.6, carbs: 23, fat: 0.9 },
                    { name: { fr: "L√©gumes vapeur (200g)", en: "Steamed vegetables (200g)", ar: "ÿÆÿ∂ÿ±Ÿàÿßÿ™ ŸÖÿ∑ŸáŸàÿ© ÿπŸÑŸâ ÿßŸÑÿ®ÿÆÿßÿ± (200 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 200, calories: 55, protein: 3.7, carbs: 11, fat: 0.6 },
                    { name: { fr: "Huile d'olive (1 c. √† soupe)", en: "Olive oil (1 tbsp)", ar: "ÿ≤Ÿäÿ™ ÿ≤Ÿäÿ™ŸàŸÜ (1 ŸÖŸÑÿπŸÇÿ© ÿ∑ÿπÿßŸÖ)" }, baseQuantity: 15, calories: 884, protein: 0, carbs: 0, fat: 100 }
                ]
            },
            afternoonSnack: {
                name: { fr: "Collation de l'apr√®s-midi", en: "Afternoon snack", ar: "Ÿàÿ¨ÿ®ÿ© ÿÆŸÅŸäŸÅÿ© ÿ®ÿπÿØ ÿßŸÑÿ∏Ÿáÿ±" },
                baseCalories: 200,
                foods: [
                    { name: { fr: "Pomme ou poire", en: "Apple or pear", ar: "ÿ™ŸÅÿßÿ≠ÿ© ÿ£Ÿà ÿ•ÿ¨ÿßÿµ" }, baseQuantity: 100, calories: 52, protein: 0.3, carbs: 14, fat: 0.2 },
                    { name: { fr: "Noix (20g)", en: "Nuts (20g)", ar: "ŸÖŸÉÿ≥ÿ±ÿßÿ™ (20 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 20, calories: 607, protein: 20, carbs: 21, fat: 54 }
                ]
            },
            dinner: {
                name: { fr: "D√Æner", en: "Dinner", ar: "ÿßŸÑÿπÿ¥ÿßÿ°" },
                baseCalories: 500,
                foods: [
                    { name: { fr: "Poulet grill√© (120g)", en: "Grilled chicken (120g)", ar: "ÿØÿ¨ÿßÿ¨ ŸÖÿ¥ŸàŸä (120 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 120, calories: 165, protein: 31, carbs: 0, fat: 3.6 },
                    { name: { fr: "Riz complet (100g cuit)", en: "Brown rice (100g cooked)", ar: "ÿ£ÿ±ÿ≤ ÿ®ŸÜŸä (100 ÿ¨ÿ±ÿßŸÖ ŸÖÿ∑ÿ®ŸàÿÆ)" }, baseQuantity: 100, calories: 111, protein: 2.6, carbs: 23, fat: 0.9 },
                    { name: { fr: "Salade verte (150g)", en: "Green salad (150g)", ar: "ÿ≥ŸÑÿ∑ÿ© ÿÆÿ∂ÿ±ÿßÿ° (150 ÿ¨ÿ±ÿßŸÖ)" }, baseQuantity: 150, calories: 15, protein: 1, carbs: 3, fat: 0.2 },
                    { name: { fr: "Huile d'olive (1 c. √† soupe)", en: "Olive oil (1 tbsp)", ar: "ÿ≤Ÿäÿ™ ÿ≤Ÿäÿ™ŸàŸÜ (1 ŸÖŸÑÿπŸÇÿ© ÿ∑ÿπÿßŸÖ)" }, baseQuantity: 15, calories: 884, protein: 0, carbs: 0, fat: 100 }
                ]
            }
        };
        
        // √âcouteurs d'√©v√©nements
        nextToGoalBtn.addEventListener('click', goToGoalSection);
        backToPersonalBtn.addEventListener('click', goToPersonalSection);
        nextToResultsBtn.addEventListener('click', goToResultsSection);
        backToGoalBtn.addEventListener('click', backToGoalSection);
        nextToPlanBtn.addEventListener('click', goToPlanSection);
        backToResultsBtn.addEventListener('click', backToResultsSection);
        restartBtn.addEventListener('click', restartApp);
        
        // Gestionnaire de langue
        languageBtn.addEventListener('click', () => {
            languageOptions.classList.toggle('show');
        });
        
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', () => {
                const lang = option.getAttribute('data-lang');
                setLanguage(lang);
                languageOptions.classList.remove('show');
            });
        });
        
        // Navigation entre les sections
        function goToGoalSection() {
            if (!validatePersonalInfo()) return;
            
            personalInfoSection.classList.add('hidden');
            goalSection.classList.remove('hidden');
            updateSteps(2);
        }
        
        function goToPersonalSection() {
            goalSection.classList.add('hidden');
            personalInfoSection.classList.remove('hidden');
            updateSteps(1);
        }
        
        function goToResultsSection() {
            if (!validateGoal()) return;
            
            goalSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            calculateResults();
            updateSteps(3);
        }
        
        function backToGoalSection() {
            resultsSection.classList.add('hidden');
            goalSection.classList.remove('hidden');
            updateSteps(2);
        }
        
        function goToPlanSection() {
            resultsSection.classList.add('hidden');
            planSection.classList.remove('hidden');
            generateNutritionPlan();
            updateSteps(4);
        }
        
        function backToResultsSection() {
            planSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            updateSteps(3);
        }
        
        function restartApp() {
            planSection.classList.add('hidden');
            personalInfoSection.classList.remove('hidden');
            document.getElementById('personalInfoForm').reset();
            document.getElementById('goalForm').reset();
            updateSteps(1);
        }
        
        // Mise √† jour de l'indicateur de progression
        function updateSteps(activeStep) {
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < activeStep) {
                    step.classList.add('completed');
                } else if (index + 1 === activeStep) {
                    step.classList.add('active');
                }
            });
        }
        
        // Validation des informations personnelles
        function validatePersonalInfo() {
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const weight = document.getElementById('weight').value;
            const height = document.getElementById('height').value;
            const activityLevel = document.getElementById('activityLevel').value;
            
            if (!age || !gender || !weight || !height || !activityLevel) {
                alert(currentLang === 'fr' ? 'Veuillez remplir tous les champs' : 
                      currentLang === 'en' ? 'Please fill in all fields' : 
                      'Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ');
                return false;
            }
            
            userData.age = parseInt(age);
            userData.gender = gender;
            userData.weight = parseFloat(weight);
            userData.height = parseInt(height);
            userData.activityLevel = parseFloat(activityLevel);
            
            return true;
        }
        
        // Validation de l'objectif
        function validateGoal() {
            const goal = document.querySelector('input[name="goal"]:checked');
            const intensity = document.getElementById('intensity').value;
            
            if (!goal || !intensity) {
                alert(currentLang === 'fr' ? 'Veuillez s√©lectionner un objectif et une intensit√©' : 
                      currentLang === 'en' ? 'Please select a goal and intensity' : 
                      'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ŸáÿØŸÅ Ÿàÿ¥ÿØÿ©');
                return false;
            }
            
            userData.goal = goal.value;
            userData.intensity = parseInt(intensity);
            
            return true;
        }
        
        // Calcul des r√©sultats avec les nouvelles r√®gles de prot√©ines et lipides
        function calculateResults() {
            // Calcul du BMR (M√©tabolisme de base)
            if (userData.gender === 'male') {
                userData.bmr = 10 * userData.weight + 6.25 * userData.height - 5 * userData.age + 5;
            } else {
                userData.bmr = 10 * userData.weight + 6.25 * userData.height - 5 * userData.age - 161;
            }
            
            // Calcul du TDEE (D√©pense √©nerg√©tique totale)
            userData.tdee = userData.bmr * userData.activityLevel;
            
            // Calcul des calories selon l'objectif
            if (userData.goal === 'muscle') {
                userData.goalCalories = Math.round(userData.tdee + userData.intensity);
                goalDescription.textContent = currentLang === 'fr' ? 
                    `Pour prendre du muscle, vous devez consommer ${userData.intensity} calories de plus que votre d√©pense √©nerg√©tique.` :
                    currentLang === 'en' ?
                    `To gain muscle, you need to consume ${userData.intensity} calories more than your energy expenditure.` :
                    `ŸÑÿßŸÉÿ™ÿ≥ÿßÿ® ÿßŸÑÿπÿ∂ŸÑÿßÿ™ÿå ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿßÿ≥ÿ™ŸáŸÑÿßŸÉ ${userData.intensity} ÿ≥ÿπÿ±ÿ© ÿ≠ÿ±ÿßÿ±Ÿäÿ© ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿ•ŸÜŸÅÿßŸÇŸÉ ŸÑŸÑÿ∑ÿßŸÇÿ©.`;
            } else if (userData.goal === 'weightLoss') {
                userData.goalCalories = Math.round(userData.tdee - userData.intensity);
                goalDescription.textContent = currentLang === 'fr' ? 
                    `Pour perdre du poids, vous devez consommer ${userData.intensity} calories de moins que votre d√©pense √©nerg√©tique.` :
                    currentLang === 'en' ?
                    `To lose weight, you need to consume ${userData.intensity} calories less than your energy expenditure.` :
                    `ŸÑŸÅŸÇÿØÿßŸÜ ÿßŸÑŸàÿ≤ŸÜÿå ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿßÿ≥ÿ™ŸáŸÑÿßŸÉ ${userData.intensity} ÿ≥ÿπÿ±ÿ© ÿ≠ÿ±ÿßÿ±Ÿäÿ© ÿ£ŸÇŸÑ ŸÖŸÜ ÿ•ŸÜŸÅÿßŸÇŸÉ ŸÑŸÑÿ∑ÿßŸÇÿ©.`;
            } else {
                userData.goalCalories = Math.round(userData.tdee);
                goalDescription.textContent = currentLang === 'fr' ? 
                    `Pour maintenir votre poids, vous devez consommer l'√©quivalent de votre d√©pense √©nerg√©tique.` :
                    currentLang === 'en' ?
                    `To maintain your weight, you need to consume the equivalent of your energy expenditure.` :
                    `ŸÑŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ Ÿàÿ≤ŸÜŸÉÿå ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿßÿ≥ÿ™ŸáŸÑÿßŸÉ ŸÖÿß ŸäÿπÿßÿØŸÑ ÿ•ŸÜŸÅÿßŸÇŸÉ ŸÑŸÑÿ∑ÿßŸÇÿ©.`;
            }
            
            // Calcul des prot√©ines selon les nouvelles r√®gles
            if (userData.goal === 'muscle') {
                userData.protein = userData.gender === 'male' ? 
                    Math.round(userData.weight * 1.5) : 
                    Math.round(userData.weight * 1.2);
                proteinInfo.textContent = userData.gender === 'male' ? 
                    "(1.5g par kg de poids)" : "(1.2g par kg de poids)";
            } else if (userData.goal === 'weightLoss') {
                userData.protein = userData.gender === 'male' ? 
                    Math.round(userData.weight * 2) : 
                    Math.round(userData.weight * 1.5);
                proteinInfo.textContent = userData.gender === 'male' ? 
                    "(2g par kg de poids)" : "(1.5g par kg de poids)";
            } else {
                userData.protein = Math.round(userData.weight * 1.2);
                proteinInfo.textContent = "(1.2g par kg de poids)";
            }
            
            // Calcul des lipides selon les nouvelles r√®gles
            if (userData.goal === 'muscle') {
                userData.fat = Math.round(userData.weight * 1);
                fatInfo.textContent = "(1g par kg de poids)";
            } else if (userData.goal === 'weightLoss') {
                userData.fat = userData.gender === 'male' ? 
                    Math.round(userData.weight * 0.7) : 
                    Math.round(userData.weight * 0.8);
                fatInfo.textContent = userData.gender === 'male' ? 
                    "(0.7g par kg de poids)" : "(0.8g par kg de poids)";
            } else {
                userData.fat = Math.round(userData.weight * 1);
                fatInfo.textContent = "(1g par kg de poids)";
            }
            
            // Les glucides repr√©sentent le reste des calories
            const proteinCalories = userData.protein * 4;
            const fatCalories = userData.fat * 9;
            const remainingCalories = userData.goalCalories - proteinCalories - fatCalories;
            userData.carbs = Math.max(0, Math.round(remainingCalories / 4));
            
            // Affichage des r√©sultats
            bmrResult.textContent = `${Math.round(userData.bmr)} ${currentLang === 'fr' ? 'calories' : currentLang === 'en' ? 'calories' : 'ÿ≥ÿπÿ±ÿ©'}`;
            tdeeResult.textContent = `${Math.round(userData.tdee)} ${currentLang === 'fr' ? 'calories' : currentLang === 'en' ? 'calories' : 'ÿ≥ÿπÿ±ÿ©'}`;
            goalCaloriesResult.textContent = `${userData.goalCalories} ${currentLang === 'fr' ? 'calories' : currentLang === 'en' ? 'calories' : 'ÿ≥ÿπÿ±ÿ©'}`;
            proteinResult.textContent = `${userData.protein}g`;
            fatResult.textContent = `${userData.fat}g`;
            carbsResult.textContent = `${userData.carbs}g`;
            
            dailyCaloriesPlan.textContent = userData.goalCalories;
        }
        
        // G√©n√©ration du plan nutritionnel adaptatif
        function generateNutritionPlan() {
            nutritionPlan.innerHTML = '';
            
            // Facteur d'ajustement selon les calories totales
            const baseCalories = 2000; // Calories de r√©f√©rence du plan de base
            const adjustmentFactor = userData.goalCalories / baseCalories;
            
            // G√©n√©rer chaque repas
            Object.values(mealStructure).forEach(meal => {
                const mealCard = document.createElement('div');
                mealCard.className = 'meal-card';
                
                const mealTitle = document.createElement('div');
                mealTitle.className = 'meal-title';
                mealTitle.textContent = meal.name[currentLang] || meal.name.fr;
                mealCard.appendChild(mealTitle);
                
                let totalCalories = 0;
                let totalProtein = 0;
                let totalCarbs = 0;
                let totalFat = 0;
                
                // Ajouter chaque aliment du repas
                meal.foods.forEach(food => {
                    // Ajuster la quantit√© selon les calories n√©cessaires
                    const adjustedQuantity = Math.round(food.baseQuantity * adjustmentFactor);
                    const ratio = adjustedQuantity / 100;
                    
                    const foodCalories = food.calories * ratio;
                    const foodProtein = food.protein * ratio;
                    const foodCarbs = food.carbs * ratio;
                    const foodFat = food.fat * ratio;
                    
                    const foodItem = document.createElement('div');
                    foodItem.className = 'food-item';
                    
                    const foodName = document.createElement('span');
                    foodName.className = 'food-name';
                    foodName.textContent = food.name[currentLang] || food.name.fr;
                    
                    const foodQuantity = document.createElement('span');
                    foodQuantity.className = 'food-quantity';
                    foodQuantity.textContent = `${adjustedQuantity}g`;
                    
                    foodItem.appendChild(foodName);
                    foodItem.appendChild(foodQuantity);
                    mealCard.appendChild(foodItem);
                    
                    totalCalories += foodCalories;
                    totalProtein += foodProtein;
                    totalCarbs += foodCarbs;
                    totalFat += foodFat;
                });
                
                // Ajouter le total du repas
                const mealTotal = document.createElement('div');
                mealTotal.className = 'meal-total';
                
                const totalLabel = document.createElement('span');
                totalLabel.textContent = currentLang === 'fr' ? 'Total:' : currentLang === 'en' ? 'Total:' : 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπ:';
                
                const totalValue = document.createElement('span');
                totalValue.textContent = `${Math.round(totalCalories)} ${currentLang === 'fr' ? 'cal' : currentLang === 'en' ? 'cal' : 'ÿ≥ÿπÿ±ÿ©'}, ${totalProtein.toFixed(1)}g ${currentLang === 'fr' ? 'prot√©ines' : currentLang === 'en' ? 'protein' : 'ÿ®ÿ±Ÿàÿ™ŸäŸÜ'}, ${totalCarbs.toFixed(1)}g ${currentLang === 'fr' ? 'glucides' : currentLang === 'en' ? 'carbs' : 'ŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™'}, ${totalFat.toFixed(1)}g ${currentLang === 'fr' ? 'lipides' : currentLang === 'en' ? 'fat' : 'ÿØŸáŸàŸÜ'}`;
                
                mealTotal.appendChild(totalLabel);
                mealTotal.appendChild(totalValue);
                mealCard.appendChild(mealTotal);
                
                nutritionPlan.appendChild(mealCard);
            });
        }
        
        // Changer la langue de l'application
        function setLanguage(lang) {
            currentLang = lang;
            currentLanguage.textContent = translations[lang].currentLanguage;
            
            // Mettre √† jour tous les textes de l'interface
            document.getElementById('appTitle').textContent = translations[lang].appTitle;
            document.getElementById('appSubtitle').textContent = translations[lang].appSubtitle;
            document.getElementById('personalInfoTitle').textContent = translations[lang].personalInfoTitle;
            document.getElementById('ageLabel').textContent = translations[lang].ageLabel;
            document.getElementById('genderLabel').textContent = translations[lang].genderLabel;
            document.getElementById('genderDefault').textContent = translations[lang].genderDefault;
            document.getElementById('genderMale').textContent = translations[lang].genderMale;
            document.getElementById('genderFemale').textContent = translations[lang].genderFemale;
            document.getElementById('weightLabel').textContent = translations[lang].weightLabel;
            document.getElementById('heightLabel').textContent = translations[lang].heightLabel;
            document.getElementById('activityLabel').textContent = translations[lang].activityLabel;
            document.getElementById('activityDefault').textContent = translations[lang].activityDefault;
            document.getElementById('activitySedentary').textContent = translations[lang].activitySedentary;
            document.getElementById('activityLight').textContent = translations[lang].activityLight;
            document.getElementById('activityModerate').textContent = translations[lang].activityModerate;
            document.getElementById('activityActive').textContent = translations[lang].activityActive;
            document.getElementById('activityExtreme').textContent = translations[lang].activityExtreme;
            document.getElementById('nextToGoalBtn').textContent = translations[lang].nextButton;
            document.getElementById('goalTitle').textContent = translations[lang].goalTitle;
            document.getElementById('goalQuestion').textContent = translations[lang].goalQuestion;
            document.getElementById('goalMuscleLabel').textContent = translations[lang].goalMuscleLabel;
            document.getElementById('goalWeightLossLabel').textContent = translations[lang].goalWeightLossLabel;
            document.getElementById('goalMaintainLabel').textContent = translations[lang].goalMaintainLabel;
            document.getElementById('intensityLabel').textContent = translations[lang].intensityLabel;
            document.getElementById('intensityDefault').textContent = translations[lang].intensityDefault;
            document.getElementById('intensityLight').textContent = translations[lang].intensityLight;
            document.getElementById('intensityModerate').textContent = translations[lang].intensityModerate;
            document.getElementById('intensityIntense').textContent = translations[lang].intensityIntense;
            document.getElementById('backToPersonalBtn').textContent = translations[lang].previousButton;
            document.getElementById('nextToResultsBtn').textContent = translations[lang].calculateButton;
            document.getElementById('resultsTitle').textContent = translations[lang].resultsTitle;
            document.getElementById('bmrTitle').textContent = translations[lang].bmrTitle;
            document.getElementById('bmrDescription').textContent = translations[lang].bmrDescription;
            document.getElementById('tdeeTitle').textContent = translations[lang].tdeeTitle;
            document.getElementById('tdeeDescription').textContent = translations[lang].tdeeDescription;
            document.getElementById('goalCaloriesTitle').textContent = translations[lang].goalCaloriesTitle;
            document.getElementById('macrosTitle').textContent = translations[lang].macrosTitle;
            document.getElementById('proteinLabel').textContent = translations[lang].proteinLabel;
            document.getElementById('fatLabel').textContent = translations[lang].fatLabel;
            document.getElementById('carbsLabel').textContent = translations[lang].carbsLabel;
            document.getElementById('carbsInfo').textContent = translations[lang].carbsInfo;
            document.getElementById('backToGoalBtn').textContent = translations[lang].previousButton;
            document.getElementById('nextToPlanBtn').textContent = translations[lang].viewPlanButton;
            document.getElementById('planTitle').textContent = translations[lang].planTitle;
            document.getElementById('planDescription').textContent = `${translations[lang].planDescription} `;
            document.getElementById('backToResultsBtn').textContent = translations[lang].previousButton;
            document.getElementById('restartBtn').textContent = translations[lang].restartButton;
            
            // Si nous sommes sur la page des r√©sultats, recalculer pour mettre √† jour les textes
            if (!resultsSection.classList.contains('hidden')) {
                calculateResults();
            }
            
            // Si nous sommes sur la page du plan, reg√©n√©rer le plan
            if (!planSection.classList.contains('hidden')) {
                generateNutritionPlan();
            }
            
            // Ajuster la direction du texte pour l'arabe
            if (lang === 'ar') {
                document.body.style.direction = 'rtl';
                document.body.style.textAlign = 'right';
            } else {
                document.body.style.direction = 'ltr';
                document.body.style.textAlign = 'left';
            }
        }
        
        // Initialisation
        updateSteps(1);
        setLanguage('fr'); // Langue par d√©faut
    </script>
</body>
</html>
